<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-netlify-cms="site.title">Panditan Di Hatti</title>
  <link rel="icon" type="image/png" href="images/LOGO.png" data-netlify-cms="site.favicon"/>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins&display=swap');
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0; padding: 0;
      background: #fffdf6; color: #333;
    }
    header.hero {
      background: linear-gradient(120deg, #ffc107, #ff9800);
      padding: 70px 20px 40px;
      text-align: center;
      position: relative;
      animation: fadeIn 1.5s ease-in-out;
    }
    header.hero img.logo {
      position: absolute; top: 15px; left: 15px;
      width: 70px; height: auto;
    }
    header.hero h1 {
      font-family: 'Playfair Display', serif;
      font-size: 3.2em; margin: 0;
    }
    header.hero .tagline {
      font-size: 1.2em; margin-top: 10px;
      font-style: italic; color: #4e342e;
    }
    header.hero .status {
      font-weight: bold; margin-top: 15px;
      font-size: 1.1em;
    }
    header.hero a.zomato-order {
      display: inline-block; margin-top: 20px;
      padding: 12px 25px; text-decoration: none;
      border-radius: 8px; font-weight: bold;
      transition: background 0.3s;
    }
    a.zomato-order.open { background: #e23744; color: white; }
    a.zomato-order.closed { background: #ccc; color: #555; pointer-events: none; }
    section {
      padding: 40px 20px; max-width: 1000px; margin: auto;
    }
    section h2 {
      color: #b14520;
      font-size: 2em;
      font-family: 'Playfair Display', serif;
      margin-bottom: 15px;
    }
    .menu-item { display:flex; align-items:center; gap:20px; flex-wrap:wrap; margin-bottom:25px; }
    .menu-item img { width:140px; height:100px; object-fit:cover; border-radius:10px; }
    .reviews .review { background:#fffaf0; padding:15px; margin-bottom:20px; border-radius:8px; box-shadow:0 3px 8px rgba(0,0,0,0.05); }
    .review strong { color:#d35400; }
    .review-link { text-align:center; margin:30px; }
    .review-link a { background:#3f51b5; color:white; padding:10px 20px; text-decoration:none; border-radius:8px; font-weight:bold; }
    footer { background:#ffe0b2; text-align:center; padding:20px; color:#333; }
    @keyframes fadeIn { 0%{opacity:0;transform:translateY(-20px);}100%{opacity:1;transform:translateY(0);} }
  </style>
</head>
<body>
  <header class="hero">
    <img src="images/LOGO.png" class="logo" alt="Logo">
    <h1 data-netlify-cms="site.title">Panditan Di Hatti</h1>
    <p class="tagline" data-netlify-cms="site.tagline">Where Tradition Meets Taste — Since 1980 in Hamirpur</p>
    <div id="openStatus" class="status">Checking status...</div>
    <a id="zomatoBtn" class="zomato-order" target="_blank">Order on Zomato</a>
  </header>

  <section class="about">
    <h2>About Us</h2>
    <p id="about-text">Loading...</p>
    <img id="owner-image" src="images/OWNER.png" alt="Owner Photo">
  </section>

  <section class="menu">
    <h2>Our Specialties</h2>
    <div id="menu-list">Loading menu...</div>
  </section>

  <section class="reviews">
    <h2>⭐ Customer Reviews</h2>
    <div id="review-list">Loading reviews...</div>
    <div class="review-link"><a href="#">✍️ Write a Review</a></div>
  </section>

  <footer>
    <p data-netlify-cms="site.footer">© 2025 Panditan Di Hatti | Designed by Harshit</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked-frontmatter@1.0.0/browser.min.js"></script>
  <script>
    // Highlight today's hours and open status
    const now = new Date();
    const today = now.getDay();
    const openMins = 8 * 60, closeMins = 20 * 60 + 30;
    const totalMins = now.getHours() * 60 + now.getMinutes();
    const isOpen = totalMins >= openMins && totalMins <= closeMins;
    document.getElementById('openStatus').textContent = isOpen ? '✅ We’re Open Now' : '❌ We’re Closed Now';
    const btn = document.getElementById('zomatoBtn');
    btn.classList.add(isOpen ? 'open' : 'closed');

    async function fetchYAML(url) {
      const res = await fetch(url);
      const text = await res.text();
      return jsyaml.load(text);
    }

    async function fetchMarkdownList(path) {
      const res = await fetch(`https://api.github.com/repos/YOUR_USERNAME/YOUR_REPO/contents/${path}`);
      const files = await res.json();
      const all = await Promise.all(
        files.filter(f => f.name.endsWith('.md')).map(async file => {
          const mdRes = await fetch(file.download_url);
          const mdText = await mdRes.text();
          const content = window.marked.parseFrontMatter(mdText);
          return content.attributes;
        })
      );
      return all;
    }

    function insertMenuItems(menu) {
      const container = document.getElementById('menu-list');
      container.innerHTML = menu.map(item => `
        <div class="menu-item">
          <img src="${item.image}" alt="${item.title}">
          <div><strong>${item.title}:</strong> ${item.description}</div>
        </div>
      `).join('');
    }

    function insertReviews(reviews) {
      const container = document.getElementById('review-list');
      container.innerHTML = reviews.map(r => `
        <div class="review"><strong>${r.name}:</strong> ${r.body}</div>
      `).join('');
    }

    async function loadDynamicContent() {
      const about = await fetchYAML('about.yml');
      document.getElementById('about-text').textContent = about.description;
      document.getElementById('owner-image').src = about.image;

      const menu = await fetchMarkdownList('content/menu');
      insertMenuItems(menu);

      const reviews = await fetchMarkdownList('content/reviews');
      insertReviews(reviews);
    }

    window.addEventListener('DOMContentLoaded', loadDynamicContent);
  </script>
</body>
</html>
